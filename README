This is a subset of my code that may be of general use.